# Fantom

Fantom is a cli tool for generating API layer based on OpenAPI Spec.


### Usage
1. Install `fantom`
    ```shell
    $ dart pub global activate fantom
    ```
2. Generate API client
    ```shell
    $ fantom generate openapi.yaml --dir=lib/src/network 
    ```
   **Note:** it will generates models in `lib/src/network/model` directory and APIs in `lib/src/network/api` directory
    
### More Advanced Options

- Separate models and APIs directories
    ```shell
    $ fantom generate openapi.yaml --model-dir=lib/src/model --api-dir=lib/src/network
    ```    
- Generate API layer as a standalone dart package
    ```shell
    $ fantom generate openapi.yaml --package=packages/network
    ```
    
    **Note:** it will generates a package called `network` inside `packages/network` from where `fantom generate` command runs.
    
 - Define configs inside `pubspec.yaml`
     ```shell
    $ fantom generate 
    # or
    $ fantom generate pubspec.yaml
    ```
    Your `pubspec.yaml` file:
    ```yaml
    fantom:
      - openapi: openapi.yaml   
      - api-dir: lib/src/network
      - model-dir: lib/src/model
    # or
    fantom: 
      - openapi: openapi.yaml
      - dir: lib/src/network
    # or
    fantom: 
      - openapi: openapi.yaml
      - package: packages/network  
    ```        

  **Side Note:** fantom almost everywhere uses the same method to read `json` or `yaml` files
  the file name and extension is irrelevent to fantom just the file content should be in valid format whether it is `json` or `yaml`. you can event write your fantom config in json format if you need to

### Read openapi file from URL

With fantom it is possible to path a url as the source of `openapi` file.

NOTE: you must also provide a path to store the downloaded file


here is how your fantom config will look like

```yaml
fantom:
  openapi: https://myopenapi.com/source/of/openapi
  download-path: where/to/save/openapi.json 
  api-dir: packages/network/lib
  model-dir: packages/network/lib/models
  package-name: network
  excluded-paths:
    - /error
  excluded-components:
    - components/schemas/ModelAndView
```

### Exclude Paths and Components

you can exclude some paths and components from being generated by fantom cli. what happens
is fantom will read the openapi files and then remove the paths and components you excluded
so they won't be generated.

you can add the components and path you want to your fantom config to be excluded like below example

```yaml
fantom:
  openapi: openapi_files/petstore.openapi.json
  package: path/to/package/
  package-name: my_api_package
  excluded-paths:
    - /pet -- [get, post] # only exclude get & post operation
    - /pet/findByStatus # when no operation specified everything gets excluded
  excluded-components:
    - components/schemas/Shalgham
```

## Activate from Source
Activate `fantom` from source code:

```shell
$ export PATH="$PATH":"$HOME/.pub-cache/bin"

$ dart pub global activate --source path path_to/fantom
```

To deactive:
```bash
$ dart pub global deactivate fantom
```
